<!doctype html>
<html lang="fr" class="mobile">
<head>
    <meta charset="utf-8">
    <title>Anki template development</title>
    <link rel="stylesheet" href="style.css">

</head>

<body class="mobile">
<header><p><u>Chapitre de cours avec un nom :</u><b> qui peut être très long et potentiellement complexe</b></p></header>

<div id="theContent" class="inRecto">
    <div id="flippingCard">
        <div class='face' id='recto'>
            <div class="faceContent">
                Ici il doit y avoir une question sur ton cours avec des mots en <b>gras</b> des mots en <i>italique</i> et des mots <u>soulignés</u> et des <a>liens</a>
            </div>
        </div>
        <div class='face' id='verso'>
            <div class="faceContent">
                Ici il doit y avoir la réponse à la question
            </div>
        </div>
    </div>
    <div id = 'bckgCards'>
        <div class='face' id='bckgFace1'> </div>
        <div class='face' id='bckgFace2'><p>Ici il doit y avoir une question sur ton cours avec des mots en <b>gras</b> des mots en <i>italique</i> et des mots <u>soulignés</u> et des <a>liens</a></p></div>
    </div>
</div>

<script>
    console.log("Hello World");
    function revealAnswer() {
        var card = document.getElementById('flippingCard');
        if (card.style.transform === 'rotateY(180deg)') {
            card.style.transform = 'rotateY(0deg)';
        } else {
            card.style.transform = 'rotateY(180deg)';
        }
    }

    document.addEventListener("DOMContentLoaded", function() {
        const tags = ["b", "i", "u", "a"];
        tags.forEach(tag => {
            document.querySelectorAll(tag).forEach(el => {
                // Insert space before if not already there
                if (!el.previousSibling || el.previousSibling.nodeType === 3 && !el.previousSibling.textContent.endsWith('\u00A0')) {
                    el.insertAdjacentText("beforebegin", '\u00A0');
                }
                // Insert space after if not already there
                if (!el.nextSibling || el.nextSibling.nodeType === 3 && !el.nextSibling.textContent.startsWith('\u00A0')) {
                    el.insertAdjacentText("afterend", '\u00A0');
                }
            });
        });

        var theContent = document.getElementById('theContent');
        var cardContent = [document.getElementById('recto'), document.getElementById('verso'), document.getElementById('bckgCards')]
        if (document.querySelector(`.${'mobile'}`) !== null) {
            document.body.addEventListener("click", revealAnswer);
            var newCard = document.createElement('div');
            newCard.id = 'flippingCard';
            for(let i = 0; i<2; i++) {
                newCard.appendChild(cardContent[i]);
            }
            theContent.innerHTML = '';
            theContent.appendChild(newCard);
            theContent.appendChild(cardContent[2]);
        }else{
            theContent.innerHTML = '';
            theContent.appendChild(cardContent[0]); // adding recto
            if (document.querySelector(`.${'inRecto'}`) === null){
                theContent.appendChild(cardContent[1]); //adding verso if not inRecto
            }
        }
    });
</script>

</body>
</html>
